<!DOCTYPE html>
<html lang="en">

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Jay


  | Interactive Data Visualization with Dash

</title>
<meta name="description" content="Computational structural biology postdoc @ Biozentrum, University of Basel
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,400;0,700;1,400&family=Playfair+Display:wght@500&display=swap" rel="stylesheet">
<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>J</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="https://ninjani.github.io/teaching/2019-06-18-interactive-visualization/">



  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://Ninjani.github.io/">
       Jay
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      





<div class="post">

  <header class="post-header">
    <h1 class="post-title">Interactive Data Visualization with Dash</h1>
    <p class="post-meta">June 18, 2019</p>
    <p class="post-tags">
      <a href="/blog/2019"> <i class="fas fa-calendar fa-sm"></i> 2019 </a>
      

      

    </p>
  </header>

  <article class="post-content">
    <p>Required python packages for this workshop:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandas
numpy
scipy==1.3.0
plotly
dash==0.40.0
dash_bio==0.1.1
statsmodels==0.10.0
</code></pre></div></div>

<p>In this workshop we will explore the use of the Python <a href="https://dash.plot.ly/" target="_blank" rel="noopener noreferrer">Dash</a> framework to build <a href="https://dash-gallery.plotly.host/Portal/" target="_blank" rel="noopener noreferrer">interactive web applications</a>. 
For the interactive graphs we will use the <a href="https://plot.ly/d3-js-for-python-and-pandas-charts/" target="_blank" rel="noopener noreferrer">Plotly</a> graphing library that nicely integrates with Dash. 
Two examples of Dash used in bioinformatics applications: <a href="https://indelphi.giffordlab.mit.edu/single" target="_blank" rel="noopener noreferrer">inDelphi</a>, <a href="https://dash-gallery.plotly.host/dash-drug-discovery/" target="_blank" rel="noopener noreferrer">Drug Discovery</a>.</p>

<p>Here are the libraries you will need to import:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">dash</span>
<span class="kn">import</span> <span class="n">dash_core_components</span> <span class="k">as</span> <span class="n">dcc</span>
<span class="kn">import</span> <span class="n">dash_html_components</span> <span class="k">as</span> <span class="n">html</span>
<span class="kn">from</span> <span class="n">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>
<span class="kn">import</span> <span class="n">dash_bio</span>
<span class="kn">import</span> <span class="n">plotly.graph_objs</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">import</span> <span class="n">plotly.offline</span> <span class="k">as</span> <span class="n">py</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">statsmodels.api</span> <span class="k">as</span> <span class="n">sm</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<p>We will be using yeast cell cycle gene expression data from <a href="https://doi.org/10.1091/mbc.9.12.3273" target="_blank" rel="noopener noreferrer">Spellman et al.</a> to 
incrementally build up a web page to visualize different aspects of the data. 
The rows of the Pandas dataframe below represent genes, and the columns represent time points (no replicates). 
The time points are minutes after cell cycle synchronisation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">expr</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">http://www.exploredata.net/ftp/Spellman.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>We first look at the gene expression values for one particular gene (selected for no particular reason).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gene_id</span> <span class="o">=</span> <span class="sh">'</span><span class="s">YAL001C</span><span class="sh">'</span>
<span class="n">expr_gene</span> <span class="o">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gene_id</span><span class="p">]</span>
</code></pre></div></div>

<p>With the series of expression values we can make a scatter-plot using plotly’s <code class="language-plaintext highlighter-rouge">go.Scatter</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scatter_plot</span> <span class="o">=</span> <span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">expr_gene</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">expr_gene</span><span class="p">,</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="sh">'</span><span class="s">markers</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">gene_id</span>
<span class="p">)</span>
</code></pre></div></div>

<p>This code would work standalone in a Jupyter notebook using just plotly with <code class="language-plaintext highlighter-rouge">py.iplot([scatter_plot])</code> but here we’ll make a Dash app from it and run it as a script. 
The Dash app object is created with:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="p">.</span><span class="nc">Dash</span><span class="p">()</span>
<span class="n">app</span><span class="p">.</span><span class="n">css</span><span class="p">.</span><span class="nf">append_css</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">external_url</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css</span><span class="sh">'</span>
<span class="p">})</span>
</code></pre></div></div>
<p>We’ll talk about the CSS part later, but Dash also takes care of generating the actual HTML for the web page. 
It is common to use content division or div blocks to organise components on a web page. In HTML that would look like this:</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>
    some text
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>
<p>whereas in Dash you would write it as:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="sh">"</span><span class="s">some text</span><span class="sh">"</span><span class="p">])</span>
</code></pre></div></div>

<p>To add the scatter-plot figure to the page we use the Dash core component <code class="language-plaintext highlighter-rouge">Graph</code> and provide the scatter-plot as data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="p">.</span><span class="nc">Graph</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">expression_plot</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">figure</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:[</span><span class="n">scatter_plot</span><span class="p">]</span>
        <span class="p">})</span>
<span class="p">])</span>
</code></pre></div></div>

<p>Now we are ready to show the page. For that, Dash provides a built-in web server that can simply be started by calling the <code class="language-plaintext highlighter-rouge">run_server()</code> method. 
This will bring up a web server running on your local computer at port 8050. You can view the page by pointing your browser to 
http://127.0.0.1:8050/.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
  <span class="n">app</span><span class="p">.</span><span class="nf">run_server</span><span class="p">()</span>
</code></pre></div></div>
<p>Add the above code to a script (e.g. <strong>first_dash_script.py</strong>) and run using <code class="language-plaintext highlighter-rouge">python first_dash_script.py</code>. 
Check the page at http://127.0.0.1:8050/ to see the expression plot of our selected gene. 
You may notice that even this simple plot already has interactive capabilities for hovering over the points, zooming, selecting etc. 
(More interactive options can be found in the top right corner of the plot).</p>

<p>But the real power of Dash is in the way it can alter the plots being displayed based on input from other sources. 
We can see this by adding a drop-down box to select the gene we’re interested in viewing (instead of hard-coding one example) 
and having the scatter-plot change to the expression values of that gene.</p>

<p>Stop the Dash app and change the <code class="language-plaintext highlighter-rouge">app.layout</code> definition with the code below, then restart and see the changes in your browser.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="p">.</span><span class="nc">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">gene_selector</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">}</span> <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="sh">''</span><span class="p">),</span>
    <span class="n">dcc</span><span class="p">.</span><span class="nc">Graph</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">expression_plot</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">figure</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:[</span><span class="n">scatter_plot</span><span class="p">],</span>
            <span class="sh">'</span><span class="s">layout</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene_id</span>
            <span class="p">}</span>
        <span class="p">})</span>
<span class="p">])</span>
</code></pre></div></div>

<p>That was easy right?</p>

<p>Of course, it can be a bit annoying to have to stop and rerun the code every time you make a change, so instead you can 
have the Dash app dynamically check for updates of the Python code if you set:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
  <span class="n">app</span><span class="p">.</span><span class="nf">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>
<p>Then you don’t have to restart the server each time you change the code, you just have to refresh the browser page.</p>

<p>But… nothing happens to the graph if you select a different gene?!</p>

<p>This is because we’re still using the same scatter-plot, the one calculated for that single gene we hard-coded in the beginning. 
What we need instead is for Dash to recalculate the scatter-plot based on the gene selected. For that we need to add update functionality in the form of a callback function that triggers when the drop-down menu is used.</p>

<p><a href="https://medium.com/@alroth/understanding-callbacks-for-people-who-want-to-punch-javascript-in-the-face-76cb856e8469" target="_blank" rel="noopener noreferrer"><img src="https://miro.medium.com/max/260/1*c8yU2Jjm3QjjNWqAW15WkQ.jpeg" alt="Callback"></a></p>

<p>The callback function starts with a decorator <code class="language-plaintext highlighter-rouge">@app.callback</code> that defines the inputs and the outputs - this function is triggered when one of the inputs is changed and updates the corresponding outputs. In our case, the input is the selected gene id, and the output will be the scatter-plot.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@app.callback</span><span class="p">(</span>
    <span class="nc">Output</span><span class="p">(</span><span class="sh">'</span><span class="s">expression_plot</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">figure</span><span class="sh">'</span><span class="p">),</span>
    <span class="p">[</span><span class="nc">Input</span><span class="p">(</span><span class="sh">'</span><span class="s">gene_selector</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_expression_plot</span><span class="p">(</span><span class="n">gene_id</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">gene_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">expr_gene</span> <span class="o">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gene_id</span><span class="p">]</span>
        <span class="n">scatter_plot</span> <span class="o">=</span> <span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">expr_gene</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">expr_gene</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="sh">'</span><span class="s">markers</span><span class="sh">'</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">gene_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">scatter_plot</span><span class="p">]}</span>
</code></pre></div></div>

<p>This function looks for changes in the <code class="language-plaintext highlighter-rouge">value</code> field of the component with id <code class="language-plaintext highlighter-rouge">gene_selector</code>. When a change is detected, 
it makes the scatter-plot and puts it as the <code class="language-plaintext highlighter-rouge">figure</code> field of the component with id <code class="language-plaintext highlighter-rouge">expression_plot</code>.</p>

<p>Now we can remove the scatter-plot from the layout definition, as it will be calculated and rendered by the function above:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="p">.</span><span class="nc">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">gene_selector</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">}</span> <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">dcc</span><span class="p">.</span><span class="nc">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">expression_plot</span><span class="sh">'</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div></div>

<p>Congratulations on creating and running an interactive web application!</p>

<p>You are not restricted to having a single input and output in the callback function or even a single callback function in your Dash app; the final page can be a mix of interlinked plots changing according to inputs from various <a href="https://dash.plot.ly/dash-core-components" target="_blank" rel="noopener noreferrer">drop-down boxes, sliders, checkboxes etc.</a> For instance, let’s also add a regression line to the scatter-plot and have a slider that determines the smoothing fraction of the regression line.</p>

<p>We can also take the time now to add some other elements to our layout, using a simple CSS framework called <a href="http://getskeleton.com/" target="_blank" rel="noopener noreferrer">Skeleton</a> (already loaded above) to position our components. To put components on the same row you would put them all in a <code class="language-plaintext highlighter-rouge">Div</code> with the <code class="language-plaintext highlighter-rouge">className</code> as ‘row’. The web-page is divided into 12 columns (which change in size accordingly when you use a phone instead of your laptop for instance). You can make a component take up 4 columns in this layout by putting it in a <code class="language-plaintext highlighter-rouge">Div</code> with the <code class="language-plaintext highlighter-rouge">className</code> as “four columns”. 
The “container” <code class="language-plaintext highlighter-rouge">className</code> just puts everything into a Skeleton container with automatically calculated margins according to your screen size.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">H1</span><span class="p">(</span><span class="sh">'</span><span class="s">Yeast expression browser</span><span class="sh">'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">}),</span>
              <span class="n">html</span><span class="p">.</span><span class="nc">H3</span><span class="p">(</span><span class="sh">'</span><span class="s">Parameters</span><span class="sh">'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">})],</span>
             <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">row</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
        <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">(</span><span class="sh">'</span><span class="s">Smoothing fraction:</span><span class="sh">'</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">smoothing_fraction</span><span class="sh">'</span><span class="p">),</span> 
              <span class="n">dcc</span><span class="p">.</span><span class="nc">Slider</span><span class="p">(</span>
                  <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">fraction_slider</span><span class="sh">'</span><span class="p">,</span>
                  <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                  <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="sh">'</span><span class="s">1.0</span><span class="sh">'</span><span class="p">},</span>
                  <span class="n">value</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># default smoothing fraction
</span>                  <span class="p">)],</span> <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">six columns</span><span class="sh">"</span><span class="p">),</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">dcc</span><span class="p">.</span><span class="nc">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">gene_selector</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">}</span> <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">)],</span> <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">six columns</span><span class="sh">"</span><span class="p">)],</span>
            <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">container</span><span class="sh">"</span><span class="p">),</span>

        <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Br</span><span class="p">(),</span> <span class="n">html</span><span class="p">.</span><span class="nc">Br</span><span class="p">(),</span>
                            <span class="n">html</span><span class="p">.</span><span class="nc">H3</span><span class="p">(</span><span class="sh">"</span><span class="s">Expression plot</span><span class="sh">"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">}),</span>
                            <span class="n">dcc</span><span class="p">.</span><span class="nc">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">expression_plot</span><span class="sh">'</span><span class="p">)])],</span> <span class="n">className</span><span class="o">=</span><span class="sh">'</span><span class="s">row</span><span class="sh">'</span><span class="p">)])])</span>
</code></pre></div></div>

<p>We add the <code class="language-plaintext highlighter-rouge">fraction_slider</code> and <code class="language-plaintext highlighter-rouge">smoothing_fraction</code> as another input and output of our previous callback function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@app.callback</span><span class="p">(</span>
    <span class="p">[</span><span class="nc">Output</span><span class="p">(</span><span class="sh">"</span><span class="s">expression_plot</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">figure</span><span class="sh">"</span><span class="p">),</span>
     <span class="nc">Output</span><span class="p">(</span><span class="sh">"</span><span class="s">smoothing_fraction</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">children</span><span class="sh">"</span><span class="p">)],</span>
    <span class="p">[</span><span class="nc">Input</span><span class="p">(</span><span class="sh">"</span><span class="s">gene_selector</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">value</span><span class="sh">"</span><span class="p">),</span>
     <span class="nc">Input</span><span class="p">(</span><span class="sh">"</span><span class="s">fraction_slider</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">value</span><span class="sh">"</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_expression_plot</span><span class="p">(</span><span class="n">gene_id</span><span class="p">,</span> <span class="n">frac</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
     Updates the expression plot in the web-app by using gene selector and smoothing fraction input components.
    </span><span class="sh">"""</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">gene_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">smoothing_fraction</span><span class="p">:</span> 
    <span class="c1"># If any of the inputs are missing then no figure is returned
</span>        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Smoothing fraction (</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">expr_gene</span> <span class="o">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gene_id</span><span class="p">]</span>
        <span class="n">scatter_plot</span> <span class="o">=</span> <span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">expr_gene</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
                           <span class="n">y</span><span class="o">=</span><span class="n">expr_gene</span><span class="p">,</span>
                           <span class="n">mode</span><span class="o">=</span><span class="sh">'</span><span class="s">markers</span><span class="sh">'</span><span class="p">,</span>
                           <span class="n">name</span><span class="o">=</span><span class="n">gene_id</span><span class="p">)</span>
        <span class="n">smooth_line</span> <span class="o">=</span> <span class="n">sm</span><span class="p">.</span><span class="n">nonparametric</span><span class="p">.</span><span class="nf">lowess</span><span class="p">(</span><span class="n">expr_gene</span><span class="p">,</span>
                                              <span class="n">pd</span><span class="p">.</span><span class="nf">to_numeric</span><span class="p">(</span><span class="n">expr_gene</span><span class="p">.</span><span class="n">index</span><span class="p">),</span>
                                              <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">)</span>

        <span class="n">regression_line</span> <span class="o">=</span> <span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">smooth_line</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">smooth_line</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                            <span class="n">mode</span><span class="o">=</span><span class="sh">'</span><span class="s">lines</span><span class="sh">'</span><span class="p">,</span>
                            <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">shape</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">spline</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">smoothing</span><span class="sh">'</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">},</span>
                            <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">Lowess</span><span class="sh">'</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">scatter_plot</span><span class="p">,</span> <span class="n">regression_line</span><span class="p">]},</span>  <span class="sa">f</span><span class="sh">"</span><span class="s">Smoothing fraction (</span><span class="si">{</span><span class="n">frac</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span>
</code></pre></div></div>

<p>Try that out!</p>

<p>Finally, while Dash and Plotly provide many basic plots such as <a href="https://plot.ly/python/" target="_blank" rel="noopener noreferrer">line charts, bar charts, seaborn style charts, contour plots etc.</a>, a new and very interesting development is <a href="https://dash.plot.ly/dash-bio" target="_blank" rel="noopener noreferrer">Dash-Bio</a>, a library that provides Dash components for common bioinformatics visualization tasks. You can play around with some examples on their <a href="https://dash-bio.plotly.host/Portal/" target="_blank" rel="noopener noreferrer">demo server</a> but below we use the <code class="language-plaintext highlighter-rouge">Clustergram</code> component to add a heatmap with associated dendogram to our expression browser. This is done by updating the layout and adding another callback function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">app</span><span class="p">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">H1</span><span class="p">(</span><span class="sh">'</span><span class="s">Yeast expression browser</span><span class="sh">'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">}),</span>
              <span class="n">html</span><span class="p">.</span><span class="nc">H3</span><span class="p">(</span><span class="sh">'</span><span class="s">Parameters</span><span class="sh">'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">})],</span>
             <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">row</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
        <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">(</span><span class="sh">'</span><span class="s">Smoothing fraction:</span><span class="sh">'</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">smoothing_fraction</span><span class="sh">'</span><span class="p">),</span> <span class="n">dcc</span><span class="p">.</span><span class="nc">Slider</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">fraction_slider</span><span class="sh">'</span><span class="p">,</span>
                <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="sh">'</span><span class="s">1.0</span><span class="sh">'</span><span class="p">},</span>
                <span class="n">value</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># default smoothing fraction
</span>                <span class="p">)],</span><span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">four columns</span><span class="sh">"</span><span class="p">),</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">dcc</span><span class="p">.</span><span class="nc">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">gene_selector</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">gene</span><span class="p">}</span> <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="n">expr</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">)],</span> <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">four columns</span><span class="sh">"</span><span class="p">),</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">(</span><span class="sh">'</span><span class="s">correlation_cutoff</span><span class="sh">'</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="sh">"</span><span class="s">cor_value</span><span class="sh">"</span><span class="p">),</span> <span class="n">dcc</span><span class="p">.</span><span class="nc">Slider</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">cor_slider</span><span class="sh">'</span><span class="p">,</span>
                <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="sh">'</span><span class="s">1.0</span><span class="sh">'</span><span class="p">},</span>
                <span class="n">value</span><span class="o">=</span><span class="mf">0.6</span> <span class="c1"># default correlation cutoff
</span>                <span class="p">)],</span> <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">four columns</span><span class="sh">"</span><span class="p">)],</span>
            <span class="n">className</span><span class="o">=</span><span class="sh">"</span><span class="s">container</span><span class="sh">"</span><span class="p">),</span>
        <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Br</span><span class="p">(),</span> <span class="n">html</span><span class="p">.</span><span class="nc">Br</span><span class="p">(),</span> <span class="n">html</span><span class="p">.</span><span class="nc">H3</span><span class="p">(</span><span class="sh">"</span><span class="s">Expression plot</span><span class="sh">"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">}),</span>
                      <span class="n">dcc</span><span class="p">.</span><span class="nc">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">expression_plot</span><span class="sh">'</span><span class="p">)],</span>
                     <span class="n">className</span><span class="o">=</span><span class="sh">'</span><span class="s">six columns</span><span class="sh">'</span><span class="p">),</span>
            <span class="n">html</span><span class="p">.</span><span class="nc">Div</span><span class="p">([</span><span class="n">html</span><span class="p">.</span><span class="nc">Br</span><span class="p">(),</span> <span class="n">html</span><span class="p">.</span><span class="nc">Br</span><span class="p">(),</span>
                      <span class="n">html</span><span class="p">.</span><span class="nc">H3</span><span class="p">(</span><span class="sh">"</span><span class="s">Heatmap</span><span class="sh">"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text-align</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">}),</span>
                      <span class="n">dcc</span><span class="p">.</span><span class="nc">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="sh">'</span><span class="s">heatmap_plot</span><span class="sh">'</span><span class="p">)],</span>
                     <span class="n">className</span><span class="o">=</span><span class="sh">'</span><span class="s">six columns</span><span class="sh">'</span><span class="p">)],</span> <span class="n">className</span><span class="o">=</span><span class="sh">'</span><span class="s">row</span><span class="sh">'</span><span class="p">)])])</span>

<span class="nd">@app.callback</span><span class="p">(</span>
    <span class="p">[</span><span class="nc">Output</span><span class="p">(</span><span class="sh">'</span><span class="s">heatmap_plot</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">figure</span><span class="sh">'</span><span class="p">),</span>
     <span class="nc">Output</span><span class="p">(</span><span class="sh">'</span><span class="s">cor_value</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">children</span><span class="sh">'</span><span class="p">)],</span>
    <span class="p">[</span><span class="nc">Input</span><span class="p">(</span><span class="sh">'</span><span class="s">gene_selector</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">),</span>
     <span class="nc">Input</span><span class="p">(</span><span class="sh">'</span><span class="s">cor_slider</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_clustergram</span><span class="p">(</span><span class="n">gene_id</span><span class="p">,</span> <span class="n">cor</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Updates the clustergram/heatmap in the webapp by using gene selector and correlation slider input components.
    </span><span class="sh">"""</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">gene_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">cor</span><span class="p">:</span> 
    <span class="c1"># If any of the inputs are missing then no figure is returned
</span>        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Correlation cutoff (</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">expr_gene</span> <span class="o">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gene_id</span><span class="p">]</span>
        <span class="n">cor_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">corrcoef</span><span class="p">(</span><span class="n">expr_gene</span><span class="p">,</span> <span class="n">expr</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;=</span> <span class="n">cor</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cor_expr</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">heatmap</span> <span class="o">=</span> <span class="n">dashbio</span><span class="p">.</span><span class="nc">Clustergram</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">cor_expr</span><span class="p">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">column_labels</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">cor_expr</span><span class="p">.</span><span class="n">columns</span><span class="p">),</span>
                <span class="n">row_labels</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">cor_expr</span><span class="p">.</span><span class="n">index</span><span class="p">),</span>
                <span class="n">cluster</span><span class="o">=</span><span class="sh">'</span><span class="s">row</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
                <span class="n">hide_labels</span><span class="o">=</span><span class="sh">'</span><span class="s">column</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">display_ratio</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
                <span class="n">optimal_leaf_order</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="n">heatmap</span><span class="p">},</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Correlation cutoff (</span><span class="si">{</span><span class="n">cor</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Correlation cutoff </span><span class="si">{</span><span class="n">cor</span><span class="si">}</span><span class="s"> is too high!</span><span class="sh">"</span>
</code></pre></div></div>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    © Copyright 2025 Janani  Durairaj.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

    
    
    Last updated: February 14, 2025.
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
